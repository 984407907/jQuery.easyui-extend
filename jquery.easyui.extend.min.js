/**
 * Licensed under the GPL licenses
 * http://www.gnu.org/licenses/gpl.txt
 *
 * @author: 爱看书不识字<zjh527@163.com>
 * @date: 2013-7-4
 * https://github.com/loafer/jQuery.easyui-extend
 * http://blog.csdn.net/zjh527
 */
(function(c){function a(h){var j=c.extend(true,{},c.fn.combobox.defaults,c(h).combobox("options"));var f=j.customAttr.slave;if(f.id==null){return}if(/^#/.test(f.id)){f.id=f.id}else{f.id="#"+f.id}if(!j.multiple&&!j.editable){var g=j.onSelect;c(h).combobox({onSelect:function(k){g.call(h,k);b(h,f,k)}});var e=j.onChange;c(h).combo({onChange:function(l,k){e.call(h,l,k);if(l==null||l==""){c(f.id).combobox("clear").combobox("loadData",[]);c(h).combo("textbox").trigger("blur")}}})}}function b(g,h,e){if(h.remote){var f=h.url||c(h.id).combobox("options").url;if(f.indexOf("?")>-1){f+="&swd="+c(g).combobox("getValue")}else{f+="?swd="+c(g).combobox("getValue")}c(h.id).combobox("reload",f)}else{c(h.id).combobox("loadData",e.data)}}function d(f){var g=c(f).combobox("options");var e=c.extend(true,{},c.fn.combobox.defaults,g);if(!e.customAttr.headervalue){return}var h=g.onLoadSuccess;c(f).combobox({onLoadSuccess:function(){h.call(f);c(f).combobox("textbox").trigger("blur")}})}c.fn.combobox.defaults.customAttr={slave:{id:null,remote:true,url:null}};c.extend(c.fn.combobox.methods,{followCustomHandle:function(e){return e.each(function(){d(this);a(this);c(this).combo("followCustomHandle")})}})})(jQuery);(function(e){function c(j){var k=e.data(j,"combo").options;var h=e.extend(true,{},e.fn.combo.defaults,k);if(!h.customAttr.headervalue){return}if(k.required){var g=['unequal["'+h.customAttr.headervalue+'"]'];if(k.validType){if(typeof k.validType=="string"){g.push(k.validType);k.validType=g}if(e.isArray(k.validType)){e.merge(k.validType,g)}}else{e.extend(k,{validType:g})}}var f=k.onChange;e(j).combo({onChange:function(m,l){if(m==null||m==""){e(j).combo("setText",h.customAttr.headervalue)}f.call(j,m,l)}}).combo("textbox").val(h.customAttr.headervalue).attr("prompt",h.customAttr.headervalue).focus(function(){if(e(this).val()==h.customAttr.headervalue){e(this).val("")}}).blur(function(){if(e.trim(e(this).val())==""){e(this).val(h.customAttr.headervalue)}e(j).combo("validate")})}function a(g){var f=e.data(g,"combo").options;e(g).combo("setText","");if(f.multiple){e(g).combo("setValues",[])}else{e(g).combo("setValue","")}}function b(g){var f=e(g).combo("getValues");return f.length>0?(f[0]!=""?f[0]:null):null}function d(g){var h=e.extend(true,{},e.fn.combo.defaults,e.data(g,"combo").options);var f=h.customAttr.autocomplete;if(!f.enabled){return}e(g).combo("textbox").keyup(function(j){if(e(this).val().length!=0&&(e(this).val().length%f.minLength==0)&&f.url){e.ajax({type:"POST",url:f.url,data:{wd:e(this).val()},dataType:"json",success:function(m){var k=e(g).combo("panel").empty();for(var l=0;l<m.length;l++){e("<div>").addClass("combobox-item").attr("value",m[l].id).text(m[l].text).click(function(p){var n=e(this).attr("value");var o=e(this).text();e(g).combo("setValue",n).combo("setText",o).combo("hidePanel")}).hover(function(){e(this).addClass("combobox-item-hover")},function(){e(this).removeClass("combobox-item-hover")}).appendTo(k)}},error:function(k,m,l){e.messager.alert("Error",l,"error")}})}})}e.fn.combo.defaults.customAttr={headervalue:null,autocomplete:{enabled:false,minLength:3,url:undefined}};e.extend(e.fn.combo.methods,{followCustomHandle:function(f){return f.each(function(){c(this);d(this)})},clear:function(f){return f.each(function(){a(this)})},getValue:function(f){return b(f[0])}})})(jQuery);(function(c){function f(q,r,n){var p=d(q,n);var o=c("#"+p);if(o.length==0){o=c("<div>",{id:p}).menu().menu("appendItems",r)}return o}function d(o,n){return c(o).attr("id")+"_"+n}function k(o){var n={};c.each(o,function(){var q=this;if(q.onclick){var p=q.id||q.text;n[p]=q.onclick;delete q.onclick}if(q.submenu&&c.isArray(q.submenu)&&q.submenu.length>0){c.extend(n,k(q.submenu))}});return n}function e(u,q){var p=q||[];if(!c.isArray(p)){p=[]}var t=d(u,"headerContextMenu");var n=[{text:"显示/隐藏列",iconCls:"icon-columns",submenu:[{id:t+"_showAll",text:"全部显示",iconCls:"icon-columns",onclick:function(w,x,v){c.fn.datagrid.headerContextMenu.defaultEvents.doShowAll(v)}},{id:t+"_restore",text:"还原",iconCls:"icon-columns",onclick:function(w,x,v){c.fn.datagrid.headerContextMenu.defaultEvents.doRestore(v)}},"-"]}];c.merge(n,q);var o=function(v){return v.substr(v.lastIndexOf("_")+1,v.length)};var r=[];var s=c(u).datagrid("getColumnFields");c.each(s,function(w,x){if(!x){return true}var v=c(u).datagrid("getColumnOption",x);v._hidden=v.hidden;r.push({id:t+"_"+x,text:v.title,iconCls:v.hidden?"icon-unchecked":"icon-checked",onclick:function(z,y,C){var B=o(z.id);var A=c(C).datagrid("getColumnOption",B).hidden;if(!A){c.fn.datagrid.headerContextMenu.defaultEvents.doHideColumn(C,B,z)}else{c.fn.datagrid.headerContextMenu.defaultEvents.doShowColumn(C,B,z)}}})});c.merge(n[0].submenu,r);return n}function h(r){var p=c.extend(true,{},c.fn.datagrid.defaults,c(r).datagrid("options"));var t=p.customAttr.headerContextMenu;if(!t.isShow){return}var s=[];if(t.isMerge){s=e(r,t.items)}else{s=c.isArray(t.items)?t.items:[]}var q=k(s);var o=p.onHeaderContextMenu;var n=f(r,s,"headerContextMenu");c(r).datagrid({onHeaderContextMenu:function(v,u){v.preventDefault();n.menu({onClick:function(x){var w=x.id||x.text;if(q[w]){q[w].call(this,x,u,r)}}}).menu("show",{left:v.pageX,top:v.pageY});o.call(this,v,u)}})}function a(r,p){var o=p||[];if(!c.isArray(o)){o=[]}var q=d(r,"rowContextMenu");var n=[{id:q+"_add",text:"增加",iconCls:"icon-add",onclick:function(){}},{id:q+"_edit",text:"编辑",iconCls:"icon-edit",onclick:function(){}},{id:q+"_delete",text:"删除",iconCls:"icon-remove",onclick:function(u,w,v,s){c.messager.confirm("疑问","您确定要删除已选中的行？",function(t){if(t){c(s).datagrid("deleteRows",c(s).datagrid("getSelections"))}})}},"-",{id:q+"_reload",text:"刷新",iconCls:"icon-reload",onclick:function(u,w,v,s){c(s).datagrid("load")}},{id:q+"_reload_this_page",text:"刷新当前页",onclick:function(u,w,v,s){c(s).datagrid("reload")}},"-",{text:"导出",iconCls:"icon-table-export",submenu:[{id:q+"_export_this_page",text:"本页",iconCls:"icon-export-excel",onclick:function(){}},{id:q+"_export_all",text:"全部",iconCls:"icon-table-excel",onclick:function(){}}]}];c.merge(n,p);return n}function m(s){var o=c.extend(true,{},c.fn.datagrid.defaults,c(s).datagrid("options"));var p=o.customAttr.rowContextMenu;if(!p.isShow){return}var t=[];if(p.isMerge){t=a(s,p.items)}else{t=c.isArray(p.items)?p.items:[]}var r=k(t);var q=o.onRowContextMenu;var n=f(s,t,"rowContextMenu");c(s).datagrid({onRowContextMenu:function(w,x,u){w.preventDefault();var v=n.menu("options");v.onClickCallback=v.onClickCallback||v.onClick;n.menu({onClick:function(z){if(v.onClickCallback.call(this,z,x,u,s)){return}var y=z.id||z.text;if(r[y]){r[y].call(this,z,x,u,s)}}}).menu("show",{left:w.pageX,top:w.pageY});q.call(this,w,x,u)}})}function l(t){var v=c.extend(true,{},c.fn.datagrid.defaults,c(t).datagrid("options"));if(!c.isArray(v.customAttr.slaveList)){return}if(v.customAttr.slaveList.length==0){return}var u={slaveList:v.customAttr.slaveList,activeSlave:v.customAttr.activeSlave};var p=c(t);var o=[];for(var s in u.slaveList){var q={id:u.slaveList[s].id,params:{}};var r={},n;if(!u.slaveList[s].relatedfield){n=p.datagrid("options").idField;r[n]="undefined"}else{n=u.slaveList[s].relatedfield;r[u.slaveList[s].relatedfield]="undefined"}c.extend(q.params,r,u.slaveList[s].queryParams);o.push(q)}if(u.activeSlave==c.fn.datagrid.defaults.customAttr.activeSlave){p.datagrid({onDblClickRow:function(y,x){for(var w in o){o[w].params[n]=x[n];c("#"+o[w].id).datagrid("load",o[w].params)}}})}}function b(s){var x=c.extend(true,{},c.fn.datagrid.defaults,c(s).datagrid("options"));if(!x.customAttr.rowediting){return}var p=function(y){return c(y).attr("id")+"_editor_buttons_panel"};var q=120;var v=function(C){var B=p(C);if(c("#"+B).length>0){return}var z=c(C).datagrid("getPanel");var A=c(">div.datagrid-view>div.datagrid-view2>div.datagrid-body",z);A.css("position","relative");var y=c("<div>",{id:B}).addClass("dialog-button").appendTo(A).css({position:"absolute",display:"block","border-bottom":"1px solid #ddd","border-left":"1px solid #ddd","border-right":"1px solid #ddd",left:parseInt(z.width()/2)-q,"z-index":2013,display:"none",padding:"4px 5px"});c('<a href="javascript:void(0)">确定</a>').css("margin-left","0px").linkbutton({iconCls:"icon-ok"}).click(function(){var D=c(C).datagrid("getRowIndex",c(C).datagrid("getEditingRow"));c(C).datagrid("endEdit",D)}).appendTo(y);c('<a href="javascript:void(0)">取消</a>').css("margin-left","6px").linkbutton({iconCls:"icon-cancel"}).click(function(){var D=c(C).datagrid("getRowIndex",c(C).datagrid("getEditingRow"));c(C).datagrid("cancelEdit",D)}).appendTo(y)};var o=function(F,D){var y=c.data(F,"datagrid").options;var G=y.finder.getTr(F,D,"body",2);var B=G.position();var E=function(){var H=G.height(),I=G.width();var K=B.top+C.scrollTop(),J=B.left;var L=11;if(I>C.width()){J=C.width()/2-q}else{J=I/2-q}if(B.top+(H*2+L)>C.height()){K=K-(H+L)}else{K=K+H}return{top:K,left:J}};var A="#"+p(F);var z=c(F).datagrid("getPanel");var C=c(">div.datagrid-view>div.datagrid-view2>div.datagrid-body",z);c(A).css(E()).show()};var r=function(z){var y="#"+p(z);c(y).hide()};var t=x.onLoadSuccess;var w=x.onBeforeEdit;var u=x.onAfterEdit;var n=x.onCancelEdit;c(s).datagrid({onLoadSuccess:function(y){t.call(this,y);v(this)},onBeforeEdit:function(y,z){o(s,y);w.call(this,y,z)},onAfterEdit:function(y,A,z){r(s);u.call(this,y,A,z)},onCancelEdit:function(y,z){r(s);n.call(this,y,z)}})}function g(p){var o=c.extend(true,{},c.fn.datagrid.defaults,c(p).datagrid("options"));if(!o.customAttr.tooltip.enable){return}var t=function(w,v){var u={position:o.customAttr.tooltip.position,trackMouse:true,onHide:function(){c(w).tooltip("destroy")},onShow:function(){if(c.isPlainObject(v)&&v.css){c(this).tooltip("tip").css(v.css)}}};c.extend(u,c.isPlainObject(v)?v:{content:v});c(w).tooltip(u).tooltip("show")};var s=function(y,v){var z=parseInt(y.attr("datagrid-row-index"));var x=c(p).datagrid("getRows")[z];var u=function(C){var B=[];var A=c.grep(c.merge(c(p).datagrid("getColumnFields",true),c(p).datagrid("getColumnFields")),function(E,D){return c.trim(E).length>0});c.each(A,function(){var D=this;var E=c(p).datagrid("getColumnOption",D).title;B.push(E+": "+C[D])});return B.join("<br>")};var w=v?v(x,z):u(x);y.mouseover(function(){t(this,w)})};var n=function(u,v){u.mouseover(function(){var A=c(this).parent().attr("datagrid-row-index");var y=c(p).datagrid("getRows")[A];var z=c(this).attr("field");var x=y[z];var w=v?v(x,z):x;t(this,w)})};var r=function(){if(o.customAttr.tooltip.target=="row"){o.finder.getTr(p,"","allbody").each(function(){var w=c(this);if(w.hasClass("datagrid-row")){s(w,o.customAttr.tooltip.formatter)}})}else{if(o.customAttr.tooltip.fields&&c.isArray(o.customAttr.tooltip.fields)){var u=c(p).datagrid("getPanel");var v=c(">div.datagrid-view>div.datagrid-view2>div.datagrid-body",u);c.each(o.customAttr.tooltip.fields,function(){var w=this;n(c("td[field="+w+"]",v),o.customAttr.tooltip.formatter)})}}};var q=o.onLoadSuccess;c(p).datagrid({onLoadSuccess:function(u){q.call(this,u);r()}})}function j(o){var n=c.extend(true,{},c.fn.datagrid.defaults,c(o).datagrid("options"));if(!n.pagination){return}var p=n.onLoadSuccess;c(o).datagrid({onLoadSuccess:function(q){c(o).datagrid("setPagination",n.customAttr.pagination);p.call(this,q)}})}c.fn.datagrid.headerContextMenu={};c.fn.datagrid.headerContextMenu.defaultEvents={doHideColumn:function(p,o,n){c(p).datagrid("hideColumn",o);var q=c(p).datagrid("getHeaderContextMenu");q.menu("setIcon",{target:n.target,iconCls:"icon-unchecked"})},doShowColumn:function(p,o,n){c(p).datagrid("showColumn",o);var q=c(p).datagrid("getHeaderContextMenu");q.menu("setIcon",{target:n.target,iconCls:"icon-checked"})},doShowAll:function(q){var n=c(q).datagrid("getColumnFields");var r=c(q).datagrid("getHeaderContextMenu");for(i in n){c(q).datagrid("showColumn",n[i]);var o=c(q).datagrid("getColumnOption",n[i]);var p=r.menu("findItem",o.title);r.menu("setIcon",{target:p.target,iconCls:"icon-checked"})}},doRestore:function(q){var n=c(q).datagrid("getColumnFields");var r=c(q).datagrid("getHeaderContextMenu");for(i in n){var o=c(q).datagrid("getColumnOption",n[i]);var p=r.menu("findItem",o.title);if(!o._hidden){c(q).datagrid("showColumn",n[i]);r.menu("setIcon",{target:p.target,iconCls:"icon-checked"})}else{c(q).datagrid("hideColumn",n[i]);r.menu("setIcon",{target:p.target,iconCls:"icon-unchecked"})}}}};c.extend(c.fn.datagrid.defaults.editors,{my97:{init:function(n,p){var o=c('<input type="text" class="Wdate">').appendTo(n);p=p||{};p=c.extend({},p,{readOnly:true});return o.focus(function(){WdatePicker()})},getValue:function(n){return c(n).val()},setValue:function(o,n){c(o).val(n)},resize:function(p,o){var n=c(p);if(c.boxModel==true){n.width(o-(n.outerWidth()-n.width()))}else{n.width(o)}}},datetimebox:{init:function(n,p){var o=c('<input type="text" class="easyui-datetimebox">').appendTo(n);p=p||{};p=c.extend({},p,{formatter:function(q){return c.dateFormat(new Date(q),"yyyy-MM-dd hh:mm")}});return o.datetimebox(p)},getValue:function(n){return c(n).datetimebox("getValue")},setValue:function(o,n){c(o).datetimebox("setValue",n)},resize:function(o,n){c(o).datetimebox("resize",n)}},numberspinner:{init:function(n,p){var o=c('<input type="text">').appendTo(n);p=p||{};p=c.extend({},p,{min:0,editable:false});return o.numberspinner(p)},getValue:function(n){return c(n).numberspinner("getValue")},setValue:function(o,n){c(o).numberspinner("setValue",n)},resize:function(o,n){c(o).numberspinner("resize",n)}},timespinner:{init:function(n,p){var o=c('<input type="text">').appendTo(n);p=p||{};return o.timespinner(p)},getValue:function(n){return c(n).timespinner("getValue")},setValue:function(o,n){c(o).timespinner("setValue",n)},resize:function(o,n){c(o).timespinner("resize",n)}},combogrid:{init:function(n,p){var o=c('<input type="text">').appendTo(n);p=p||{};p=c.extend({},p,{panelWidth:400,editable:false});return o.combogrid(p)},getValue:function(n){return c(n).combogrid("getValue")},setValue:function(o,n){c(o).combogrid("setValue",n)},resize:function(o,n){c(o).combogrid("resize",n)}}});c.fn.datagrid.defaults.customAttr={headerContextMenu:{isShow:false,isMerge:true,items:[]},rowContextMenu:{isShow:false,isMerge:true,items:[]},pagination:{showPageList:false,showRefresh:true,beforePageText:undefined,afterPageText:undefined,displayMsg:undefined},slaveList:undefined,activeSlave:"dblclickrow",rowediting:false,tooltip:{enable:false,target:"row",position:"bottom",fields:undefined,formatter:undefined}};c.extend(c.fn.datagrid.methods,{followCustomHandle:function(n){return n.each(function(){h(this);m(this);j(this);l(this);b(this);g(this)})},getHeaderContextMenu:function(n){return c("#"+d(n[0],"headerContextMenu"))},getRowContextMenu:function(n){return c("#"+d(n[0],"rowContextMenu"))},getEditingRow:function(r){var n=c.data(r[0],"datagrid");var p=n.options;var q=n.data;var o=[];p.finder.getTr(r[0],"","allbody").each(function(){if(c(this).hasClass("datagrid-row-editing")){var s=parseInt(c(this).attr("datagrid-row-index"));o.push(q.rows[s])}});return o.length>0?o[0]:null},setPagination:function(o,n){return o.each(function(){c(this).datagrid("getPager").pagination(n)})},deleteRows:function(o,n){return o.each(function(){var q=undefined;if(!c.isArray(n)){q=[n]}else{q=n}var p=this;c.each(q,function(s,t){if(c.isPlainObject(t)){var r=c(p).datagrid("getRowIndex",t);c(p).datagrid("deleteRow",r)}else{c(p).datagrid("deleteRow",t)}})})}})})(jQuery);(function(a){a.extend({dateFormat:function(c,k){if(c==null){return null}if(k==null){var p="yyyy-MM-dd"}else{var p=k}var l=c.getFullYear().toString();var j=(c.getMonth()+1).toString();var m=c.getDate().toString();var n=c.getHours().toString();var e=c.getMinutes().toString();var o=c.getSeconds().toString();var d=p.replace(/[^y]/g,"");var q=p.replace(/[^M]/g,"");var b=p.replace(/[^d]/g,"");var g=p.replace(/[^h]/g,"");var f=p.replace(/[^m]/g,"");var h=p.replace(/[^s]/g,"");if(d.length==2){l=l.substring(2,4)}if(q.length>1&&j.length==1){j="0"+j}if(b.length>1&&m.length==1){m="0"+m}if(g.length>1&&n.length==1){n="0"+n}if(f.length>1&&e.length==1){e="0"+e}if(h.length>1&&o.length==1){o="0"+o}if(d.length>0){p=p.replace(d,l)}if(q.length>0){p=p.replace(q,j)}if(b.length>0){p=p.replace(b,m)}if(g.length>0){p=p.replace(g,n)}if(f.length>0){p=p.replace(f,e)}if(h.length>0){p=p.replace(h,o)}return p},parseDate:function(u,p){var t=new Date();if(u==null){return t}if(p==null){var m="yyyy-MM-dd"}else{var m=p}var w=m.replace(/[^y]/g,"");var l=m.replace(/[^M]/g,"");var h=m.replace(/[^d]/g,"");var x=m.replace(/[^h]/g,"");var d=m.replace(/[^m]/g,"");var f=m.replace(/[^s]/g,"");var j=m.indexOf(w);var q=w.length;var e=parseInt(u.substring(j,j+q));if(isNaN(e)){e=t.getYear()}else{if(q==2){if(e<50){e+=2000}else{e+=1900}}}var y=m.indexOf(l);var v=parseInt(u.substring(y,y+l.length));if(isNaN(v)){v=t.getMonth()}else{v-=1}var b=m.indexOf(h);var n=parseInt(u.substring(b,b+h.length));if(isNaN(n)){n=t.getDate()}var s=m.indexOf(x);var o=parseInt(u.substring(s,s+x.length));if(isNaN(o)){o=0}var c=m.indexOf(d);var k=parseInt(u.substring(c,c+d.length));if(isNaN(k)){k=0}var r=m.indexOf(f);var g=parseInt(u.substring(r,r+f.length));if(isNaN(g)){g=0}return new Date(e,v,n,o,k,g)}})})(jQuery);(function(b){function a(e,d,c){if(d&&b.isArray(d)){b.each(d,function(){var h=this;var g={};if(c){b.extend(g,{parent:c})}if(b.isPlainObject(h)){b(e).menu("appendItem",b.extend(h,g));if(h.submenu){var j=b(e).menu("findItem",h.text);a(e,h.submenu,j.target)}}else{if(h=="-"){var f=b(e).menu("appendItem",b.extend({text:h},g)).menu("findItem",h).target;b(f).removeClass("menu-item").addClass("menu-sep").removeAttr("style").empty()}}})}}b.extend(b.fn.menu.methods,{followCustomHandle:function(c){},appendItems:function(d,c){return d.each(function(){a(this,c)})}})})(jQuery);(function(e){function f(n){return e(n).attr("id")+"_contextmenu"}function g(p,q){var o=f(p);var n=e("#"+o);if(n.length==0){n=e("<div>",{id:o}).menu();n.menu("appendItems",q)}return n}function l(o){var n={};e.each(o,function(){var q=this;if(q.onclick){var p=q.id||q.text;n[p]=q.onclick;delete q.onclick}if(q.submenu&&e.isArray(q.submenu)&&q.submenu.length>0){e.extend(n,l(q.submenu))}});return n}function m(r){var o=e.extend(true,{},e.fn.tabs.defaults,e.data(r,"tabs").options);var n=o.customAttr.contextMenu;if(!n.isShow){return}var s=k(r);if(n.isMerge&&e.isArray(n.items)&&n.items.length>0){s=e.merge(s,n.items)}if(!n.isMerge&&e.isArray(n.items)&&n.items.length>0){s=n.items}var q=l(s);var p=g(r,s);e(r).tabs({onContextMenu:function(u,v,t){u.preventDefault();h(r,p,t);p.menu({onClick:function(x){var w=x.id||x.text;if(q[w]){q[w].call(this,x,v,t,r)}}}).menu("show",{left:u.pageX,top:u.pageY})}})}function h(r,p,n){var q=f(r);var o=e("#"+q+"_fixed");if(e.inArray(n,e.fn.tabs.defaults.customAttr.fixedtabs)==-1&&!e(r).tabs("getTab",n).panel("options").closable){p.menu("setText",{target:o,text:e.fn.tabs.defaults.contextMenu.itemname.unfixtab})}else{p.menu("setText",{target:o,text:e.fn.tabs.defaults.contextMenu.itemname.fixtab});if(e.inArray(n,e.fn.tabs.defaults.customAttr.fixedtabs)>-1){p.menu("disableItem",o)}else{p.menu("enableItem",o)}}o=e("#"+q+"_close");if(!e(r).tabs("getTab",n).panel("options").closable){p.menu("disableItem",o)}else{p.menu("enableItem",o)}}function k(o){var n=f(o);return[{id:n+"_reload",text:e.fn.tabs.defaults.contextMenu.itemname.reload,onclick:e.fn.tabs.defaults.contextMenu.defaultEventsHandler.reload},{id:n+"_fixed",text:e.fn.tabs.defaults.contextMenu.itemname.fixtab,onclick:function(r,s,p,q){if(r.text==e.fn.tabs.defaults.contextMenu.itemname.fixtab){e.fn.tabs.defaults.contextMenu.defaultEventsHandler.fixtab(r,s,p,q)}else{e.fn.tabs.defaults.contextMenu.defaultEventsHandler.unfixtab(r,s,p,q)}}},"-",{id:n+"_close",text:e.fn.tabs.defaults.contextMenu.itemname.close,onclick:e.fn.tabs.defaults.contextMenu.defaultEventsHandler.closetab},{id:n+"_close_others",text:e.fn.tabs.defaults.contextMenu.itemname.closeothers,onclick:e.fn.tabs.defaults.contextMenu.defaultEventsHandler.closeOthersTab},{id:n+"_close_rightside",text:e.fn.tabs.defaults.contextMenu.itemname.closerightside,onclick:e.fn.tabs.defaults.contextMenu.defaultEventsHandler.closeRightSideTabs},{id:n+"_close_all",text:e.fn.tabs.defaults.contextMenu.itemname.closeall,onclick:e.fn.tabs.defaults.contextMenu.defaultEventsHandler.closeAll}]}function a(o,n){var p=[];n++;e(o).children("div.tabs-header").find("ul li:nth-child("+n+")").each(function(){p.push(this)});return p.length>0?p[0]:null}function b(t,q,n,u){if(typeof n=="number"&&typeof q=="number"){var v=e.data(t,"tabs").tabs;if(n<0||n>v.length){return}if(q<0||q>v.length){return}if(u){var x=v[n];for(var p=n;p>q;p--){v.splice(p,1,v[p-1])}v[q]=x;var w=a(t,q);if(w){var s=a(t,n);e(w).before(s)}}else{var x=v[q];for(var o=q;o<=n;o++){v.splice(o,1,v[o+1])}v[n]=x;var w=a(t,n);if(w){var r=a(t,q);e(w).after(r)}}}}function d(q){var o=e(q).tabs("tabs");var r=[];for(var n=0;n<o.length;n++){var p=o[n];if(p.panel("options").closable==undefined||!p.panel("options").closable){r.push(p)}}return r}function c(r,q,n){var p=e("<iframe>").attr("height","98%").attr("width","100%").attr("marginheight","0").attr("marginwidth","0").attr("frameborder","0");setTimeout(function(){p.attr("src",n)},1);var o=e(r).tabs("getTab",q);o.panel("body").empty().append(p)}e.fn.tabs.defaults.contextMenu={};e.fn.tabs.defaults.contextMenu.itemname={};e.fn.tabs.defaults.contextMenu.itemname.reload="重新加载";e.fn.tabs.defaults.contextMenu.itemname.fixtab="固定标签页";e.fn.tabs.defaults.contextMenu.itemname.unfixtab="取消固定标签";e.fn.tabs.defaults.contextMenu.itemname.close="关闭标签页";e.fn.tabs.defaults.contextMenu.itemname.closeothers="关闭其他标签页";e.fn.tabs.defaults.contextMenu.itemname.closerightside="关闭右侧标签页";e.fn.tabs.defaults.contextMenu.itemname.closeall="关闭所有标签页";e.fn.tabs.defaults.contextMenu.defaultEventsHandler={reload:function(o,q,n,p){e(p).tabs("getTab",n).panel("refresh")},fixtab:function(q,s,o,r){var p=e(r).tabs("getTab",o);e(r).tabs("update",{tab:p,options:{closable:false}});var n=e.fn.tabs.defaults.customAttr.fixedtabs.length;b(r,n,o,true)},unfixtab:function(q,s,n,r){var o=d(r).length-1;var p=e(r).tabs("getTab",n);e(r).tabs("update",{tab:p,options:{closable:true}});b(r,n,o)},closetab:function(p,r,o,q){var n=e(q).tabs("getTab",o).panel("options");if(n.closable){e(q).tabs("close",o)}},closeOthersTab:function(r,q,o,s){var p=e(s).tabs("tabs");var n=e.grep(p,function(u,t){return u.panel("options").closable&&t!=o});e.each(n,function(){e(s).tabs("close",this.panel("options").title)})},closeRightSideTabs:function(q,s,o,r){var p=e(r).tabs("tabs");var n=e.grep(p,function(u,t){return t>o&&u.panel("options").closable});e.each(n,function(){e(r).tabs("close",this.panel("options").title)})},closeAll:function(q,s,o,r){var p=e(r).tabs("tabs");var n=e.grep(p,function(u,t){return u.panel("options").closable});e.each(n,function(){e(r).tabs("close",this.panel("options").title)})}};e.fn.tabs.defaults.customAttr={fixedtabs:[0],contextMenu:{isShow:false,isMerge:true,items:[]}};var j=e.extend({},e.fn.tabs.methods);e.extend(e.fn.tabs.methods,{followCustomHandle:function(n){return n.each(function(){m(this)})},add:function(o,n){return o.each(function(){var p=null;if(n.href||/^url:/.test(n.content)){p=n.href||n.content.substr(4,n.content.length);delete n.content;delete n.href}if(p){if(n.useiframe){j.add(o,n);c(this,n.title,p)}else{j.add(o,e.extend(n,{href:p}))}}else{j.add(o,n)}})}})})(jQuery);(function(b){function c(o){return b(o).attr("id")+"_contextmenu"}function d(q,r){var p=c(q);var o=b("#"+p);if(o.length==0){o=b("<div>",{id:p}).menu();o.menu("appendItems",r)}return o}function l(p){var o={};b.each(p,function(){var r=this;if(r.onclick){var q=r.id||r.text;o[q]=r.onclick;delete r.onclick}if(r.submenu&&b.isArray(r.submenu)&&r.submenu.length>0){b.extend(o,l(r.submenu))}});return o}function j(p){var o=c(p);return[{id:o+"_moveup",text:"位置上移",iconCls:"icon-moveup",onclick:b.fn.tree.contextmenu.defaultEvents.moveup},{id:o+"_movedown",text:"位置下移",iconCls:"icon-movedown",onclick:b.fn.tree.contextmenu.defaultEvents.movedown}]}function m(s){var p=b.extend(true,{},b.fn.tree.defaults,b(s).tree("options"));var o=p.customAttr.contextMenu;if(!o.isShow){return}var t=j(s);if(o.isMerge&&b.isArray(o.items)&&o.items.length>0){t=b.merge(t,o.items)}if(!o.isMerge&&b.isArray(o.items)&&o.items.length>0){t=o.items}var r=l(t);var q=d(s,t);b(s).tree({onContextMenu:function(v,u){v.preventDefault();b(s).tree("select",u.target);q.menu({onClick:function(x){var w=x.id||x.text;if(r[w]){r[w].call(this,x,u,s)}}}).menu("show",{left:v.pageX,top:v.pageY})}})}function e(u,p){var t=p.id||p.text;var v=b(u).tree("getParent",p.target);var o=h(u,v.target,false);var w=-1;for(var q=0,s=o.length;q<s;q++){var r=o[q].id||o[q].text;if(t==r){w=q-1;break}}if(w>-1){return o[w]}return null}function k(u,p){var t=p.id||p.text;var w=b(u).tree("getParent",p.target);var o=h(u,w.target,false);var v=-1;for(var q=0,s=o.length;q<s;q++){var r=o[q].id||o[q].text;if(t==r){v=q+1;break}}if(v>-1&&v<o.length){return o[v]}return null}function h(r,q,o){if(o){return b(r).tree("getChildren",q)}else{var p=[];b(q).next().find(">li>div.tree-node").each(function(){p.push(b(r).tree("getNode",this))});return p}}function a(r){var p=b.extend(true,{},b.fn.tree.defaults,b(r).tree("options"));if(!p.customAttr.expandOnNodeClick&&!p.customAttr.expandOnDblClick){return}if(p.customAttr.expandOnNodeClick){var o=p.onClick;b(r).tree({onClick:function(s){b(r).tree("toggle",s.target);o&&o.call(this,s)}});return}if(p.customAttr.expandOnDblClick){var q=p.onDblClick;b(r).tree({onDblClick:function(s){b(r).tree("toggle",s.target);q&&q.call(this,s)}})}}function g(q,p){var r=1;var o=b(q).tree("getParent",p.target);if(!o){return 1}return r+g(q,o)}function n(t,u,s){var o=s?[s]:b(t).tree("getRoots");for(var r=0;r<o.length;r++){var q=h(t,o[r].target,false);for(var p=0;p<q.length;p++){b(t).tree("expandTo",q[p].target)}u--;if(u>0){for(var p=0;p<q.length;p++){n(t,u,q[p])}}}}b.fn.tree.contextmenu={};b.fn.tree.contextmenu.defaultEvents={moveup:function(s,r,t){var p=b.extend(true,{},b.fn.tree.defaults,b(t).tree("options"));var q=e(t,r);if(q){var o=b(t).tree("pop",r.target);b(t).tree("insert",{before:q.target,data:o});p.customAttr.onAfterMove.call(this,q,r)}},movedown:function(s,r,t){var q=b.extend(true,{},b.fn.tree.defaults,b(t).tree("options"));var p=k(t,r);if(p){var o=b(t).tree("pop",r.target);b(t).tree("insert",{after:p.target,data:o});q.customAttr.onAfterMove.call(this,p,r)}}};b.fn.tree.defaults.customAttr={idField:null,textField:null,parentField:null,iconField:null,expandOnNodeClick:false,expandOnDblClick:false,contextMenu:{isShow:false,isMerge:true,items:[]},onAfterMove:function(p,o){}};b.fn.tree.defaults.loadFilter=function(t,w){var p=b(this).tree("options").customAttr;if(p&&p.parentField){var o=p.idField||"id",r=p.textField||"text",q=p.iconField||"icon",v=p.parentField||"pid";var x=[],y=[];for(var s=0,u=t.length;s<u;s++){y[t[s][o]]=t[s]}for(var s=0,u=t.length;s<u;s++){if(y[t[s][v]]&&t[s][o]!=t[s][v]){if(!y[t[s][v]]["children"]){y[t[s][v]]["children"]=[]}t[s]["text"]=t[s][r];t[s][q]&&(t[s]["iconCls"]=t[s][q]);y[t[s][v]]["children"].push(t[s])}else{t[s]["text"]=t[s][r];x.push(t[s])}}return x}return t};var f=b.extend({},b.fn.tree.methods);b.extend(b.fn.tree.methods,{followCustomHandle:function(o){return o.each(function(){m(this);a(this)})},getLevel:function(p,o){return g(p[0],o)},expandTo:function(p,o){return p.each(function(){if(b.type(o)=="number"){var q=o;n(this,q)}else{f.expandTo(p,o)}})}})})(jQuery);(function(c){function d(k){return c(k).attr("id")+"_contextmenu"}function e(m,n){var l=d(m);var k=c("#"+l);if(k.length==0){k=c("<div>",{id:l}).menu();k.menu("appendItems",n)}return k}function h(l){var k={};c.each(l,function(){var n=this;if(n.onclick){var m=n.id||n.text;k[m]=n.onclick;delete n.onclick}if(n.submenu&&c.isArray(n.submenu)&&n.submenu.length>0){c.extend(k,h(n.submenu))}});return k}function g(l){var k=d(l);return[{id:k+"_delete",text:"删除",iconCls:"icon-remove",onclick:c.fn.treegrid.headerContextMenu.defaultEvents.doRemove},"-",{id:k+"_reload",text:"刷新",iconCls:"icon-reload",onclick:c.fn.treegrid.headerContextMenu.defaultEvents.doReload}]}function j(o){var k=c.extend(true,{},c.fn.treegrid.defaults,c(o).treegrid("options"));var l=k.customAttr.contextMenu;if(!l.isShow){return}var p=g(o);if(l.isMerge&&c.isArray(l.items)&&l.items.length>0){p=c.merge(p,l.items)}if(!l.isMerge&&c.isArray(l.items)&&l.items.length>0){p=l.items}var n=h(p);var m=e(o,p);c(o).treegrid({onContextMenu:function(r,s){r.preventDefault();c(o).treegrid("select",s[k.idField]);var q=m.menu("options");q.onClickCallback=q.onClickCallback||q.onClick;m.menu({onClick:function(u){var t=u.id||u.text;if(n[t]){n[t].call(this,u,s,o)}}}).menu("show",{left:r.pageX,top:r.pageY})}})}function a(p){var m=c.extend(true,{},c.fn.treegrid.defaults,c(p).treegrid("options"));if(!m.customAttr.expandOnNodeClick&&!m.customAttr.expandOnDblClick){return}var k=m.treeField;var l=m.idField;if(m.customAttr.expandOnNodeClick){var o=m.onClickCell;c(p).treegrid({onClickCell:function(q,r){if(k==q){c(p).treegrid("toggle",r[l])}o.call(this,q,r)}});return}if(m.customAttr.expandOnDblClick){var n=m.onDblClickCell;c(p).treegrid({onDblClickCell:function(q,r){if(k==q){c(p).treegrid("toggle",r[l])}n.call(this,q,r)}})}}function b(p){var u=c.extend(true,{},c.fn.treegrid.defaults,c(p).treegrid("options"));if(!u.customAttr.rowediting){return}var m=function(v){return c(v).attr("id")+"_editor_buttons_panel"};var n=120;var s=function(z){var y=m(z);if(c("#"+y).length>0){return}var w=c(z).treegrid("getPanel");var x=c(">div.datagrid-view>div.datagrid-view2>div.datagrid-body",w);x.css("position","relative");var v=c("<div>",{id:y}).addClass("dialog-button").appendTo(x).css({position:"absolute",display:"block","border-bottom":"1px solid #ddd","border-left":"1px solid #ddd","border-right":"1px solid #ddd",left:parseInt(w.width()/2)-n,"z-index":2013,display:"none",padding:"4px 5px"});c('<a href="javascript:void(0)">确定</a>').css("margin-left","0px").linkbutton({iconCls:"icon-ok"}).click(function(){var A=u.idField;var B=c(z).treegrid("getEditingRow");c(z).treegrid("endEdit",B[A])}).appendTo(v);c('<a href="javascript:void(0)">取消</a>').css("margin-left","6px").linkbutton({iconCls:"icon-cancel"}).click(function(){var A=u.idField;var B=c(z).treegrid("getEditingRow");c(z).treegrid("cancelEdit",B[A])}).appendTo(v)};var l=function(B,D){var w=u.idField;var C=u.finder.getTr(B,D[w],"body",2);var y=C.position();var x="#"+m(B);var v=c(B).treegrid("getPanel");var z=c(">div.datagrid-view>div.datagrid-view2>div.datagrid-body",v);var A=function(){var E=C.height(),F=C.width();var H=y.top+z.scrollTop(),G=y.left;var I=11;if(F>z.width()){G=z.width()/2-n}else{G=F/2-n}if(y.top+(E*2+I)>z.height()){H=H-(E+I)}else{H=H+E}return{top:H,left:G}};c(x).css(A()).show()};var o=function(w){var v="#"+m(w);c(v).hide()};var q=u.onLoadSuccess;var t=u.onBeforeEdit;var r=u.onAfterEdit;var k=u.onCancelEdit;c(p).treegrid({onLoadSuccess:function(w,v){q.call(this,w,v);s(this)},onBeforeEdit:function(v){l(p,v);t.call(this,v)},onAfterEdit:function(w,v){o(p);r.call(this,w,v)},onCancelEdit:function(v){o(p);k.call(this,v)}})}function f(m){var l=c.extend(true,{},c.fn.treegrid.defaults,c(m).treegrid("options"));if(!l.customAttr.tooltip.enable){return}var q=function(t,s){var r={position:l.customAttr.tooltip.position,trackMouse:true,onHide:function(){c(t).tooltip("destroy")},onShow:function(){if(c.isPlainObject(s)&&s.css){c(this).tooltip("tip").css(s.css)}}};c.extend(r,c.isPlainObject(s)?s:{content:s});c(t).tooltip(r).tooltip("show")};var p=function(w,s){var v=c(w).attr("node-id");var u=c(m).treegrid("find",v);var r=function(z){var y=[];var x=c.grep(c.merge(c(m).treegrid("getColumnFields",true),c(m).treegrid("getColumnFields")),function(B,A){return c.trim(B).length>0});c.each(x,function(){var A=this;var B=c(m).treegrid("getColumnOption",A).title;y.push(B+": "+z[A])});return y.join("<br>")};var t=s?s(v,u):r(u);c(w).mouseover(function(){q(this,t)})};var k=function(r,s){r.mouseover(function(){var w=c(this).parent().attr("node-id");var u=c(m).treegrid("find",w);var x=c(this).attr("field");var v=u[x];var t=s?s(v,x,w,u):v;q(this,t)})};var o=function(){if(l.customAttr.tooltip.target=="row"){l.finder.getTr(m,"","allbody").each(function(){if(c(this).hasClass("datagrid-row")){p(this,l.customAttr.tooltip.formatter)}})}else{if(l.customAttr.tooltip.fields&&c.isArray(l.customAttr.tooltip.fields)){var r=c(m).treegrid("getPanel");var s=c(">div.datagrid-view>div.datagrid-view2>div.datagrid-body",r);c.each(l.customAttr.tooltip.fields,function(){var t=this;k(c("td[field="+t+"]",s),l.customAttr.tooltip.formatter)})}}};var n=l.onLoadSuccess;c(m).treegrid({onLoadSuccess:function(s,r){n.call(this,s,r);o()}})}c.fn.treegrid.headerContextMenu={};c.fn.treegrid.headerContextMenu.defaultEvents={doRemove:function(k,m,l){c.messager.confirm("疑问","您确定要删除已选中的行？",function(o){if(o){var n=c(l).treegrid("options").idField;var p=m[n];c(l).treegrid("remove",p)}})},doReload:function(k,m,l){c(l).treegrid("reload")}};c.fn.treegrid.defaults.customAttr={iconField:null,parentField:null,expandOnNodeClick:false,expandOnDblClick:false,contextMenu:{isShow:false,isMerge:true,items:[]},rowediting:false,tooltip:{enable:false,target:"row",position:"bottom",fields:undefined,formatter:undefined}};c.fn.treegrid.defaults.loadFilter=function(m,o){var s=c(this).treegrid("options");var r=s.customAttr;if(r&&r.parentField){var k=s.idField,q=r.parentField,l=r.iconField||"icon";for(var n=0,p=m.rows.length;n<p;n++){if(m.rows[n][k]!=m.rows[n][q]){m.rows[n]["_parentId"]=m.rows[n][q]}else{delete m.rows[n][q]}m.rows[n]["iconCls"]=m.rows[n][l]}}return m};c.extend(c.fn.treegrid.methods,{followCustomHandle:function(k){return k.each(function(){j(this);a(this);b(this);f(this)})},getEditingRow:function(m){var k=m.treegrid("options");var l=[];k.finder.getTr(m[0],"","allbody").each(function(){if(c(this).hasClass("datagrid-row-editing")){var n=c(this).attr("node-id");l.push(m.treegrid("find",n))}});return l.length>0?l[0]:null}})})(jQuery);(function(a){a.extend(a.fn.validatebox.defaults.rules,{unequal:{validator:function(b,c){return b!=c},message:a.fn.validatebox.defaults.missingMessage},minLength:{validator:function(b,c){return b.length>=c[0]}},equals:{validator:function(b,c){if(/^#/.test(c)){return b==a(c).val()}else{return b==c}}}});if(a.fn.validatebox){a.fn.validatebox.defaults.rules.minLength.message="请至少输入{0}个字符。";a.fn.validatebox.defaults.rules.equals.message="字段不匹配"}})(jQuery);(function($){function getTop(w,options){var _doc;try{_doc=w.top.document;_doc.getElementsByTagName}catch(e){return w}if(options.locate=="document"||_doc.getElementsByTagName("frameset").length>0){return w}return w.top}function setWindowSize(w,options){var _top=getTop(w,options);var wHeight=$(_top).height(),wWidth=$(_top).width();if(options.locate=="top"||options.locate=="document"){if(options.height=="auto"){options.height=wHeight*0.6}if(options.width=="auto"){options.width=wWidth*0.6}}else{var locate=/^#/.test(options.locate)?options.locate:"#"+options.locate;if(options.height=="auto"){options.height=$(locate).height()*0.6}if(options.width=="auto"){options.width=$(locate).width()*0.6}}}$.extend({showWindow:function(options){options=options||{};var target;var winOpts=$.extend({},{iconCls:"icon-form",useiframe:false,locate:"top",data:undefined,width:"auto",height:"auto",cache:false,minimizable:true,maximizable:true,collapsible:true,resizable:true,onClose:function(){target.dialog("destroy")}},options);var iframe=null;if(/^url:/.test(winOpts.content)){var url=winOpts.content.substr(4,winOpts.content.length);if(winOpts.useiframe){iframe=$("<iframe>").attr("height","98%").attr("width","100%").attr("marginheight",0).attr("marginwidth",0).attr("frameborder",0);setTimeout(function(){iframe.attr("src",url)},10)}else{winOpts.href=url}delete winOpts.content}var callbackArguments={getData:function(name){return winOpts.data?winOpts.data[name]:null},close:function(){target.panel("close")}};var _top=getTop(window,winOpts);var warpHandler=function(handler){if(typeof handler=="function"){return function(){handler(callbackArguments)}}if(typeof handler=="string"&&winOpts.useiframe){return function(){iframe[0].contentWindow[handler](callbackArguments)}}if(typeof handler=="string"){return function(){eval(_top[handler])(callbackArguments)}}};setWindowSize(window,winOpts);if(winOpts.toolbar&&$.isArray(winOpts.toolbar)){$.each(winOpts.toolbar,function(i,button){button.handler=warpHandler(button.handler)})}if(winOpts.buttons&&$.isArray(winOpts.buttons)){$.each(winOpts.buttons,function(i,button){button.handler=warpHandler(button.handler)})}var onLoadCallback=winOpts.onLoad;winOpts.onLoad=function(){onLoadCallback&&onLoadCallback.call(this,callbackArguments,_top)};if(winOpts.locate=="top"||winOpts.locate=="document"){if(winOpts.useiframe&&iframe){iframe.bind("load",function(){onLoadCallback&&onLoadCallback.call(this,callbackArguments,iframe[0].contentWindow)});target=_top.$("<div>").append(iframe).dialog(winOpts)}else{target=_top.$("<div>").dialog(winOpts)}}else{var locate=/^#/.test(winOpts.locate)?winOpts.locate:"#"+winOpts.locate;target=$("<div>").appendTo(locate).dialog($.extend({},winOpts,{inline:true}))}},showModalDialog:function(options){options=options||{};var opts=$.extend({},options,{modal:true,minimizable:false,maximizable:false,resizable:false,collapsible:false});$.showWindow(opts)}})})(jQuery);